# TODO: We might want to just add in the necessary information to generator-exec
# and reuse that. This otherwise might get too complicated.
#
# However, it isn't great to include a bunch of information in the generator config
# that wouldn't be read by any generator.
#
# We'll use this for development purposes to keep things separate.

imports:
  features: features.yml
types:
  EndpointId:
    docs: |
      A unique identifier for an endpoint. This is interchangeable with the
      identifier used between the IR and the snippets API.
    type: string

  Name:
    docs: |
      A name in various formats.
    properties:
      originalName: string
      camelCase: string
      pascalCase: string
      snakeCase: string
      screamingSnakeCase: string

  ReadmeConfig:
    docs: |
      The configuration specified by the user.
    properties:
      organization: Name
      publishInfo: optional<PublishInfo>
      bannerLink: optional<string>
      docsLink: optional<string>
      featureEndpoints:
        docs: |
          The list of endpoints associated with a particular feature.
          The README.md will include each of the associated snippets
          written by the generator.
        type: optional<map<features.FeatureId, list<EndpointId>>>

  PublishInfo:
    docs: |
      A separate, simpler representation of the publish information
      found in the generator-exec configuration. This is used to
      generate README.md badges.
    union:
      npm: NpmPublishInfo
      pypi: PypiPublishInfo
      go: GoPublishInfo
      maven: MavenPublishInfo

  NpmPublishInfo:
    properties:
      packageName: string

  PypiPublishInfo:
    properties:
      packageName: string

  GoPublishInfo:
    properties:
      owner: string
      repo: string

  MavenPublishInfo:
    properties:
      artifact: string
      group: string

service:
  auth: true
  base-path: /readme
  endpoints:
    generate:
      path: /generate
      docs: Generates a README.md using the provided configuration.
      display-name: Generate README.md
      method: POST
      availability: pre-release
      audiences:
        - external
        - fiddle
      request:
        name: GenerateReadmeRequest
        body:
          properties:
            readmeConfig: ReadmeConfig
            featuresConfig: features.FeaturesConfig

            # TODO: We need to reference the generator-exec snippets here.
            snippets: unknown
