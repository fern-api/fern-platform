# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  rootCommons: ../../../commons.yml

service:
  base-path: /registry/docs
  auth: false
  audiences:
    - write
  endpoints:
    startDocsRegister:
      auth: true
      method: POST
      path: /init
      request:
        name: StartDocsRegisterRequest
        body:
          properties:
            domain: string
            orgId: rootCommons.OrgId
            filepaths:
              type: list<FilePath>
              docs: Relative filepath from docs folder.
      response: StartDocsRegisterResponse

    finishDocsRegister:
      auth: true
      method: POST
      path: /register/{docsRegistrationId}
      path-parameters:
        docsRegistrationId: DocsRegistrationId
      request:
        name: RegisterDocsRequest
        body:
          properties:
            docsDefinition: DocsDefinition
      errors:
        - rootCommons.UnauthorizedError
        - rootCommons.UserNotInOrgError
        - DocsRegistrationIdNotFound

types:
  FilePath:
    type: string
    docs: Each string is a unique key for the file. You can use the filepath as a key.

  DocsRegistrationId: string

  StartDocsRegisterResponse:
    properties:
      docsRegistrationId: DocsRegistrationId
      uploadUrls: map<FilePath, FileS3UploadUrl>

  FileS3UploadUrl:
    properties:
      uploadUrl: string
      fileId:
        type: FileId
        docs: |
          When reading docs we will return a map<FileId, URL> that you can use to look up the docs.

  FileId: string

  Height: double

  PageId: string

  Url: string

  DocsDefinition:
    properties:
      pages: map<PageId, PageContent>
      config: DocsConfig

  PageContent:
    properties:
      markdown: string # eventually PageContent should just be a FileId ?

  DocsConfig:
    properties:
      title: optional<string>
      navigation: NavigationConfig
      logo: optional<FileId>
      logoV2: optional<LogoV2>
      logoHeight: optional<Height>
      logoHref: optional<Url>
      favicon: optional<FileId>
      backgroundImage: optional<FileId>
      colors: optional<ColorsConfig>
      colorsV2: optional<ColorsConfigV2>
      navbarLinks: optional<list<NavbarLink>>
      typography: optional<DocsTypographyConfig>

  LogoV2:
    properties:
      dark: optional<FileId>
      light: optional<FileId>

  DocsTypographyConfig:
    properties:
      headingsFont: optional<FontConfig>
      bodyFont: optional<FontConfig>
      codeFont: optional<FontConfig>

  FontConfig:
    properties:
      name: string
      fontFile: FileId

  NavbarLink:
    union:
      primary: NavbarPrimaryLink
      secondary: NavbarSecondaryLink

  NavbarPrimaryLink:
    properties:
      url: string
      text: string

  NavbarSecondaryLink:
    properties:
      url: string
      text: string

  NavigationConfig:
    discriminated: false
    union:
      - UnversionedNavigationConfig
      - VersionedNavigationConfig

  UnversionedNavigationConfig:
    discriminated: false
    union:
      - UnversionedTabbedNavigationConfig
      - UnversionedUntabbedNavigationConfig

  UnversionedTabbedNavigationConfig:
    properties:
      tabs: list<NavigationTab>

  NavigationTab:
    properties:
      title: string
      icon: string
      items: list<NavigationItem>

  UnversionedUntabbedNavigationConfig:
    properties:
      items: list<NavigationItem>

  VersionedNavigationConfig:
    properties:
      versions: list<VersionedNavigationConfigData>

  VersionedNavigationConfigData:
    properties:
      version: string
      config: UnversionedNavigationConfig

  NavigationItem:
    union:
      page: PageMetadata
      api: ApiSection
      section: DocsSection

  PageMetadata:
    properties:
      title: string
      id: PageId
      urlSlugOverride: optional<string>

  ApiSection:
    properties:
      title: string
      api: rootCommons.ApiDefinitionId
      artifacts: optional<ApiArtifacts>

  DocsSection:
    properties:
      title: string
      items: list<NavigationItem>
      urlSlugOverride: optional<string>
      collapsed: optional<boolean>

  ColorsConfig:
    properties:
      accentPrimary: optional<RgbColor>

  ColorsConfigV2:
    properties:
      accentPrimary: optional<ColorConfig>
      background: optional<ColorConfig>

  ColorConfig:
    union:
      unthemed: ColorUnthemedConfig
      themed: ColorThemedConfig

  ColorUnthemedConfig:
    properties:
      color: optional<RgbColor>

  ColorThemedConfig:
    properties:
      dark: optional<RgbColor>
      light: optional<RgbColor>

  RgbColor:
    properties:
      r: integer
      g: integer
      b: integer

  ApiArtifacts:
    properties:
      sdks: list<PublishedSdk>
      postman: optional<PublishedPostmanCollection>

  PublishedPostmanCollection:
    properties:
      url: string
      githubRepoName: optional<string>

  PublishedSdk:
    union:
      npm: NpmPackage
      maven: MavenPackage
      pypi: PypiPackage

  NpmPackage:
    properties:
      packageName: string
      githubRepoName: string
      version: string

  MavenPackage:
    properties:
      coordinate: string
      githubRepoName: string
      version: string

  PypiPackage:
    properties:
      packageName: string
      githubRepoName: string
      version: string

  InvalidDomainErrorBody:
    properties:
      requiredDomainSuffix:
        type: string
        docs: Value the domain should end with (i.e. docs.buildwithfern.com or dev.docs.buildwithfern.com)

  InvliadCustomDomainErrorBody:
    properties:
      overlappingDomains: list<OverlappingCustomDomains>

  OverlappingCustomDomains: list<string>

errors:
  DocsRegistrationIdNotFound:
    status-code: 404
